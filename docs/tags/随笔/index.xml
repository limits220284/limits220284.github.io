<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>éšç¬” | Hugo Academic CV Theme</title>
    <link>http://localhost:1313/tags/%E9%9A%8F%E7%AC%94/</link>
      <atom:link href="http://localhost:1313/tags/%E9%9A%8F%E7%AC%94/index.xml" rel="self" type="application/rss+xml" />
    <description>éšç¬”</description>
    <generator>Hugo Blox Builder (https://hugoblox.com)</generator><language>en-us</language><lastBuildDate>Fri, 28 Mar 2025 00:00:00 +0000</lastBuildDate>
    <image>
      <url>http://localhost:1313/media/icon_hu7729264130191091259.png</url>
      <title>éšç¬”</title>
      <link>http://localhost:1313/tags/%E9%9A%8F%E7%AC%94/</link>
    </image>
    
    <item>
      <title>From unique to cleanups and weak new low-level tools for efficiency</title>
      <link>http://localhost:1313/post/202503282156/</link>
      <pubDate>Fri, 28 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/202503282156/</guid>
      <description>&lt;h2 id=&#34;-èƒŒæ™¯ä¸åŠ¨æœº&#34;&gt;ğŸ“Œ èƒŒæ™¯ä¸åŠ¨æœº&lt;/h2&gt;
&lt;p&gt;åœ¨è¿‡å»ï¼ŒGo è¯­è¨€æä¾›äº† &lt;code&gt;runtime.SetFinalizer&lt;/code&gt; æ–¹æ³•æ¥å¤„ç†å¯¹è±¡è¢«åƒåœ¾å›æ”¶æ—¶çš„æ¸…ç†æ“ä½œï¼ˆFinalizerï¼‰ã€‚&lt;br&gt;
ä½† Finalizer å­˜åœ¨ä¸€äº›å›ºæœ‰é—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœå¯¹è±¡ä¹‹é—´æœ‰å¾ªç¯å¼•ç”¨ï¼ŒFinalizer å¯èƒ½æ°¸è¿œä¸ä¼šè¢«è°ƒç”¨ï¼Œå¯¼è‡´å†…å­˜æ³„æ¼ã€‚&lt;/li&gt;
&lt;li&gt;Finalizer ä¼šå»¶è¿Ÿå¯¹è±¡çš„å›æ”¶ï¼Œè‡³å°‘éœ€è¦ä¸¤ä¸ªåƒåœ¾å›æ”¶å‘¨æœŸæ‰èƒ½å½»åº•æ¸…é™¤å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;Finalizer æœ‰å¯èƒ½è®©å¯¹è±¡â€œå¤æ´»â€ï¼ˆResurrectionï¼‰ï¼Œå¯¼è‡´åŸæœ¬åº”è¢«é‡Šæ”¾çš„å¯¹è±¡æ„å¤–å­˜æ´»ä¸‹æ¥ï¼Œé€ æˆå†…å­˜æµªè´¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å› æ­¤ï¼ŒGo åœ¨ 1.24 ç‰ˆæœ¬æ¨å‡ºäº†ä¸¤ä¸ªæ–°åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;runtime.AddCleanup&lt;/code&gt;&lt;/strong&gt;ï¼šæ›´å®‰å…¨çš„å¯¹è±¡æ¸…ç†æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;weak.Pointer&lt;/code&gt;&lt;/strong&gt;ï¼šå¼±å¼•ç”¨æŒ‡é’ˆç±»å‹ï¼Œå¯ä»¥å¼•ç”¨å¯¹è±¡ä½†ä¸ä¼šé˜»æ­¢å¯¹è±¡è¢«å›æ”¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä¸¤ä¸ªåŠŸèƒ½ç»“åˆä½¿ç”¨ï¼Œèƒ½æœ‰æ•ˆè§£å†³ä¼ ç»Ÿ Finalizer çš„é—®é¢˜ï¼Œå¹¶æ„å»ºæ›´é«˜æ•ˆã€æ›´å®‰å…¨çš„æ•°æ®ç»“æ„ï¼Œæ¯”å¦‚ç¼“å­˜æˆ–å»é‡æœºåˆ¶ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-ä¸€runtimeaddcleanupå®‰å…¨æ¸…ç†å‡½æ•°&#34;&gt;ğŸ“Œ ä¸€ã€&lt;code&gt;runtime.AddCleanup&lt;/code&gt;ï¼ˆå®‰å…¨æ¸…ç†å‡½æ•°ï¼‰&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;runtime.AddCleanup&lt;/code&gt; å…è®¸ç»™ä¸€ä¸ªå¯¹è±¡é™„åŠ ä¸€ä¸ªâ€œæ¸…ç†å‡½æ•°â€ï¼Œå½“è¯¥å¯¹è±¡å˜å¾—ä¸å¯è¾¾ï¼ˆå³åƒåœ¾å›æ”¶åï¼‰æ—¶ï¼Œæ¸…ç†å‡½æ•°å°†è¢«æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;ç¤ºä¾‹ï¼šä½¿ç”¨å†…å­˜æ˜ å°„æ–‡ä»¶ï¼ˆmemory-mapped fileï¼‰&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;main&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;os&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;runtime&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;syscall&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// MemoryMappedFile è¡¨ç¤ºä¸€ä¸ªå†…å­˜æ˜ å°„æ–‡ä»¶å¯¹è±¡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// é€šè¿‡è¯¥å¯¹è±¡å¯ç›´æ¥è®¿é—®æ–‡ä»¶å†…å®¹ï¼Œæ— éœ€åå¤è¯»å–ç£ç›˜
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// å½“å¯¹è±¡ä¸å†ä½¿ç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨é‡Šæ”¾å†…å­˜æ˜ å°„èµ„æº
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;MemoryMappedFile&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// æ–‡ä»¶å†…å®¹çš„å†…å­˜æ˜ å°„åŒºåŸŸ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// NewMemoryMappedFile åˆ›å»ºä¸€ä¸ªå†…å­˜æ˜ å°„æ–‡ä»¶å¯¹è±¡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// filename: éœ€è¦è¢«æ˜ å°„çš„æ–‡ä»¶è·¯å¾„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;NewMemoryMappedFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;filename&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MemoryMappedFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// æ‰“å¼€æŒ‡å®šæ–‡ä»¶
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// ç¡®ä¿å‡½æ•°ç»“æŸæ—¶è‡ªåŠ¨å…³é—­æ–‡ä»¶å¥æŸ„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// è·å–æ–‡ä»¶ä¿¡æ¯ï¼ˆä¸»è¦æ˜¯ä¸ºäº†è·å–æ–‡ä»¶å¤§å°ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;fi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Stat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// è·å–åº•å±‚ç³»ç»Ÿçš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆfile descriptorï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;conn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;SyscallConn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// ä½¿ç”¨conn.Controlå®‰å…¨åœ°æ‹¿åˆ°æ–‡ä»¶æè¿°ç¬¦å¹¶æ‰§è¡Œå†…å­˜æ˜ å°„æ“ä½œ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;connErr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;conn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Control&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fd&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// syscall.Mmap å°†æ–‡ä»¶å†…å®¹æ˜ å°„åˆ°å†…å­˜
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Mmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;// æ–‡ä»¶æè¿°ç¬¦
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;                  &lt;span class=&#34;c1&#34;&gt;// æ˜ å°„çš„èµ·å§‹ä½ç½®ï¼Œä»æ–‡ä»¶å¤´å¼€å§‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()),&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;// æ˜ å°„çš„é•¿åº¦ä¸ºæ–‡ä»¶çš„å¤§å°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;nx&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PROT_READ&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// æ˜ å°„åŒºåŸŸæƒé™ï¼šåªè¯»
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;nx&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MAP_SHARED&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// å…±äº«æ¨¡å¼ï¼Œå¯è¢«å¤šä¸ªè¿›ç¨‹è®¿é—®
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// æ£€æŸ¥æ˜ å°„è¿‡ç¨‹ä¸­æ˜¯å¦å‘ç”Ÿé”™è¯¯
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;connErr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// åˆ›å»ºå†…å­˜æ˜ å°„æ–‡ä»¶å¯¹è±¡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;mf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MemoryMappedFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// å®šä¹‰æ¸…ç†å‡½æ•°ï¼Œç”¨äºé‡Šæ”¾å†…å­˜æ˜ å°„èµ„æº
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;cleanup&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Munmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// å½“å¯¹è±¡è¢«åƒåœ¾å›æ”¶æ—¶ï¼Œè‡ªåŠ¨è§£é™¤å†…å­˜æ˜ å°„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// æ·»åŠ æ¸…ç†å‡½æ•°ï¼Œå½“ mf å¯¹è±¡ä¸å†è¢«å¼•ç”¨æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨ cleanup
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;AddCleanup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;cleanup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ä¸ºä»€ä¹ˆæ¯”ä¼ ç»Ÿ-finalizer-æ›´å®‰å…¨&#34;&gt;ä¸ºä»€ä¹ˆæ¯”ä¼ ç»Ÿ Finalizer æ›´å®‰å…¨ï¼Ÿ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä¼ ç»Ÿ Finalizer çš„é—®é¢˜ï¼šæ¸…ç†å‡½æ•°çš„å‚æ•°å¿…é¡»æ˜¯åŸå¯¹è±¡æœ¬èº«ï¼Œä¼šå¯¼è‡´å¯¹è±¡å¤æ´»ï¼Œå»¶è¿Ÿé‡Šæ”¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;AddCleanup&lt;/code&gt; æ”¹è¿›ï¼šæ¸…ç†å‡½æ•°&lt;strong&gt;ä¸å†ç›´æ¥æ¥æ”¶åŸå¯¹è±¡&lt;/strong&gt;ï¼Œè€Œæ˜¯å¦å¤–çš„ç‹¬ç«‹å‚æ•°ï¼Œä»è€Œé¿å…äº†å¯¹è±¡å¤æ´»é—®é¢˜ï¼Œå¯ä»¥ç«‹å³é‡Šæ”¾å†…å­˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-äºŒweakpointerå¼±å¼•ç”¨æŒ‡é’ˆ&#34;&gt;ğŸ“Œ äºŒã€&lt;code&gt;weak.Pointer&lt;/code&gt;ï¼ˆå¼±å¼•ç”¨æŒ‡é’ˆï¼‰&lt;/h2&gt;
&lt;p&gt;å¼±å¼•ç”¨æŒ‡é’ˆå…è®¸å¼•ç”¨ä¸€ä¸ªå¯¹è±¡ï¼Œä½†è¿™ç§å¼•ç”¨ä¸ä¼šé˜»æ­¢å¯¹è±¡è¢«åƒåœ¾å›æ”¶ã€‚å½“å¯¹è±¡è¢«å›æ”¶åï¼Œå¼±å¼•ç”¨è‡ªåŠ¨å˜æˆ &lt;code&gt;nil&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç¤ºä¾‹ï¼šå†…å­˜æ˜ å°„æ–‡ä»¶ç¼“å­˜ï¼ˆé˜²æ­¢é‡å¤åŠ è½½åŒä¸€æ–‡ä»¶ï¼‰&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;cache&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Map&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// ç¼“å­˜æ–‡ä»¶æ˜ å°„: map[string]weak.Pointer[MemoryMappedFile]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;NewCachedMemoryMappedFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;filename&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MemoryMappedFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;newFile&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MemoryMappedFile&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ok&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;cache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Load&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ok&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;newFile&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nx&#34;&gt;newFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;NewMemoryMappedFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;wp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;weak&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;newFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;loaded&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;cache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;LoadOrStore&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;wp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;loaded&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;AddCleanup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;newFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;filename&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;nx&#34;&gt;cache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;CompareAndDelete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;wp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;newFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;weak&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MemoryMappedFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]).&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;cache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;CompareAndDelete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;ä¼˜åŠ¿ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¿å…åå¤æ˜ å°„åŒä¸€ä¸ªæ–‡ä»¶ï¼Œæå‡æ•ˆç‡ã€‚&lt;/li&gt;
&lt;li&gt;ä¸éœ€è¦æ‰‹åŠ¨ç¡®å®šä½•æ—¶ç§»é™¤ç¼“å­˜æ¡ç›®ã€‚å½“å¯¹è±¡ä¸å†è¢«ä½¿ç”¨ï¼Œå¼±å¼•ç”¨è‡ªåŠ¨å˜ä¸º nilï¼Œæ­¤æ—¶å¯ä»¥è‡ªåŠ¨ä»ç¼“å­˜åˆ é™¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-ä¸‰ç»„åˆä½¿ç”¨ä¸æ³›å‹æ‰©å±•&#34;&gt;ğŸ“Œ ä¸‰ã€ç»„åˆä½¿ç”¨ä¸æ³›å‹æ‰©å±•&lt;/h2&gt;
&lt;p&gt;åˆ©ç”¨æ³›å‹ï¼Œ&lt;code&gt;weak.Pointer&lt;/code&gt; å’Œ &lt;code&gt;runtime.AddCleanup&lt;/code&gt; å¯ç”¨äºæ„å»ºé€šç”¨ç¼“å­˜ç»“æ„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Cache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;K&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;comparable&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;V&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;create&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;K&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;V&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt;      &lt;span class=&#34;nx&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Map&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Cache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;K&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;V&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;K&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;V&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;newValue&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;V&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ok&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Load&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ok&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;newValue&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nx&#34;&gt;newValue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;wp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;weak&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;newValue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;loaded&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;LoadOrStore&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;wp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;loaded&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;AddCleanup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;newValue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;K&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;CompareAndDelete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;wp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;newValue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;v&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;weak&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;V&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]).&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;v&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;CompareAndDelete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h2 id=&#34;-å››æ³¨æ„äº‹é¡¹ä¸æœªæ¥æ–¹å‘&#34;&gt;ğŸ“Œ å››ã€æ³¨æ„äº‹é¡¹ä¸æœªæ¥æ–¹å‘&lt;/h2&gt;
&lt;p&gt;å°½ç®¡æ›´å®‰å…¨ï¼Œ&lt;code&gt;runtime.AddCleanup&lt;/code&gt; å’Œ &lt;code&gt;weak.Pointer&lt;/code&gt; ä»å±äºé«˜çº§åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸è¦è®©å¯¹è±¡å’Œå…¶æ¸…ç†å‡½æ•°äº’ç›¸å¼•ç”¨ï¼Œå¦åˆ™æ¸…ç†å‡½æ•°å¯èƒ½æ°¸è¿œä¸ä¼šæ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;å¼±å¼•ç”¨æŒ‡é’ˆç”¨ä½œ Map çš„é”®æ—¶ï¼Œå…¶å¯¹åº”çš„å€¼ä¸åº”å¼•ç”¨è¯¥å¯¹è±¡æœ¬èº«ï¼Œå¦åˆ™å¯¹è±¡å¯èƒ½æ°¸è¿œæ— æ³•å›æ”¶ã€‚&lt;/li&gt;
&lt;li&gt;æ¸…ç†æ“ä½œæœ¬è´¨ä¸Šæ˜¯éç¡®å®šæ€§çš„ï¼Œéš¾ä»¥ä¸¥æ ¼æµ‹è¯•å’Œæ§åˆ¶ï¼Œä½¿ç”¨æ—¶éœ€è°¨æ…è€ƒè™‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœªæ¥æ”¹è¿›æ–¹å‘ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¼•å…¥ Ephemeronï¼ˆå¼±é”®æ˜ å°„ï¼‰è¿›ä¸€æ­¥æ”¹å–„å¼±å¼•ç”¨ä½¿ç”¨ä½“éªŒã€‚&lt;/li&gt;
&lt;li&gt;æä¾›åƒåœ¾æ”¶é›†å™¨ç›´æ¥ç®¡ç†èµ„æºï¼ˆå¦‚å†…å­˜æ˜ å°„ï¼‰çš„å¯èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-äº”ä¸ºä½•ç°åœ¨æ‰æ¨å‡º&#34;&gt;ğŸ“Œ äº”ã€ä¸ºä½•ç°åœ¨æ‰æ¨å‡ºï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å¼±å¼•ç”¨æŒ‡é’ˆåœ¨ Go ä¸­æ—©å·²è¢«è®¨è®ºï¼Œä½†é•¿æœŸæœªè¢«ä¼˜å…ˆè€ƒè™‘ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®ƒå¤æ‚å¾®å¦™ï¼Œå®¹æ˜“è¯¯ç”¨ï¼Œå¯èƒ½å¼•å…¥è¯­è¨€å¤æ‚åº¦ã€‚&lt;/li&gt;
&lt;li&gt;ä½†å¦‚ä»Šæ³›å‹æ”¯æŒã€å¯¹ Finalizer çš„é•¿æœŸç»éªŒæ€»ç»“ï¼Œä»¥åŠå…¶ä»–è¯­è¨€ï¼ˆå¦‚ Javaã€C#ï¼‰çš„ç»éªŒï¼Œè®©è¿™äº›åŠŸèƒ½çš„è®¾è®¡å’Œæ¨å‡ºå˜å¾—æˆç†Ÿå’Œå¯è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-å…­æ€»ç»“åŠŸèƒ½å¯¹æ¯”&#34;&gt;ğŸ“Œ å…­ã€æ€»ç»“ï¼ˆåŠŸèƒ½å¯¹æ¯”ï¼‰&lt;/h2&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;åŠŸèƒ½&lt;/th&gt;
          &lt;th&gt;ä¼˜åŠ¿&lt;/th&gt;
          &lt;th&gt;ç¼ºé™·&lt;/th&gt;
          &lt;th&gt;æ¨èç”¨æ³•&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;runtime.SetFinalizer&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;æ˜“ç”¨ã€ç®€å•&lt;/td&gt;
          &lt;td&gt;æ˜“é€ æˆå†…å­˜æ³„æ¼æˆ–å¯¹è±¡å¤æ´»&lt;/td&gt;
          &lt;td&gt;ä¸æ¨èï¼Œæ˜“è¯¯ç”¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;âœ… &lt;strong&gt;runtime.AddCleanup&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;ä¸é€ æˆå¯¹è±¡å¤æ´»ï¼Œç«‹å³å›æ”¶&lt;/td&gt;
          &lt;td&gt;é«˜çº§ç”¨æ³•ï¼Œæ³¨æ„å¼•ç”¨å…³ç³»&lt;/td&gt;
          &lt;td&gt;èµ„æºæ¸…ç†ï¼Œå†…å­˜æ˜ å°„&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;âœ… &lt;strong&gt;weak.Pointer&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;ä¸å½±å“åƒåœ¾å›æ”¶ï¼Œå¯å®ç°è‡ªåŠ¨ç¼“å­˜æ¸…ç†&lt;/td&gt;
          &lt;td&gt;éç¡®å®šæ€§ï¼Œéœ€è°¨æ…ä½¿ç”¨&lt;/td&gt;
          &lt;td&gt;ç¼“å­˜ã€å¯¹è±¡æ± ã€å»é‡&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;p&gt;ç»¼ä¸Šæ‰€è¿°ï¼Œ&lt;br&gt;
&lt;strong&gt;Go 1.24 çš„æ–°åŠŸèƒ½ &lt;code&gt;runtime.AddCleanup&lt;/code&gt; å’Œ &lt;code&gt;weak.Pointer&lt;/code&gt; æä¾›äº†æ›´å®‰å…¨ã€é«˜æ•ˆçš„èµ„æºç®¡ç†æœºåˆ¶ï¼Œé¿å…äº†ä¼ ç»Ÿ Finalizer çš„é‡å¤§ç¼ºé™·ã€‚ä½†ä»éœ€è°¨æ…åˆç†ä½¿ç”¨ï¼Œä»¥é¿å…å¼•å…¥æ–°çš„å¤æ‚æ€§ã€‚&lt;/strong&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>From unique to cleanups and weak new low-level tools for efficiency</title>
      <link>http://localhost:1313/post/202503301500/</link>
      <pubDate>Fri, 28 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/202503301500/</guid>
      <description>&lt;h2 id=&#34;-ä¸€èƒŒæ™¯ä¸ºä»€ä¹ˆå¹¶å‘æµ‹è¯•å¾ˆéš¾&#34;&gt;ğŸ§  ä¸€ã€èƒŒæ™¯ï¼šä¸ºä»€ä¹ˆå¹¶å‘æµ‹è¯•å¾ˆéš¾ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;Go çš„å¹¶å‘ç¼–ç¨‹å¾ˆå¼ºå¤§ï¼ˆgoroutine + channelï¼‰ï¼Œä½†&lt;strong&gt;å¹¶å‘æµ‹è¯•å´éå¸¸éš¾å†™ã€éš¾ç»´æŠ¤&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;1-è´Ÿé¢æ¡ä»¶ä¸å¥½æµ‹è¯•&#34;&gt;1. è´Ÿé¢æ¡ä»¶ä¸å¥½æµ‹è¯•&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;æ¯”å¦‚ä½ æƒ³æµ‹è¯•æŸä¸ªå‡½æ•° â€œè¿˜æ²¡æœ‰è¢«è°ƒç”¨â€ â€”â€” ä½ æ²¡æ³•æ–­è¨€æŸäº‹â€œæ²¡æœ‰å‘ç”Ÿâ€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¸¸è§å†™æ³•æ˜¯ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;calledCh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;After&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Millisecond&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// æ²¡è¢«è°ƒç”¨
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ç§æµ‹è¯•æ–¹å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€Ÿåº¦æ…¢&lt;/strong&gt;ï¼šæ¯ä¸ªæµ‹è¯•éƒ½ç­‰ 10msï¼Œå‡ ç™¾ä¸ªæµ‹è¯•ä¸‹æ¥å°±å¾ˆä¹…äº†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸ç¨³å®šï¼ˆflakyï¼‰&lt;/strong&gt;ï¼šåœ¨ CI ä¸Šå®¹æ˜“å¤±è´¥ï¼Œæ¯”å¦‚ç³»ç»Ÿå¡é¡¿ï¼Œ10ms ä¸å¤Ÿå°±è¯¯åˆ¤å¤±è´¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸ä¼˜é›…&lt;/strong&gt;ï¼šæµ‹è¯•ä¸­å¿…é¡»äººä¸ºå¼•å…¥ç­‰å¾…æ—¶é—´ï¼Œè¿˜å¯èƒ½äº§ç”Ÿ raceã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-äºŒè§£å†³æ–¹æ¡ˆsynctest-åŒ…&#34;&gt;ğŸŒŸ äºŒã€è§£å†³æ–¹æ¡ˆï¼šsynctest åŒ…&lt;/h2&gt;
&lt;p&gt;Go 1.24 å¼•å…¥äº† &lt;code&gt;testing/synctest&lt;/code&gt; å®éªŒåŒ…ï¼Œè®©&lt;strong&gt;å¹¶å‘æµ‹è¯•å˜å¾—å¿«é€Ÿã€ç¨³å®šã€æ—  race æ¡ä»¶&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;-æä¾›ä¸¤ä¸ªæ ¸å¿ƒå‡½æ•°&#34;&gt;â­ æä¾›ä¸¤ä¸ªæ ¸å¿ƒå‡½æ•°&lt;/h3&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å‡½æ•°&lt;/th&gt;
          &lt;th&gt;ä½œç”¨&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;synctest.Run(func())&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;åœ¨ä¸€ä¸ªâ€œå¹¶å‘éš”ç¦»æ°”æ³¡ï¼ˆbubbleï¼‰â€ä¸­è¿è¡Œå‡½æ•°&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;synctest.Wait()&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;ç­‰å¾…æ°”æ³¡ä¸­çš„æ‰€æœ‰ goroutine éƒ½è¿›å…¥é˜»å¡çŠ¶æ€&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-ä¸‰é‡å†™æµ‹è¯•çš„ç¤ºä¾‹å¯¹æ¯”&#34;&gt;ğŸ§ª ä¸‰ã€é‡å†™æµ‹è¯•çš„ç¤ºä¾‹å¯¹æ¯”&lt;/h2&gt;
&lt;h3 id=&#34;-åŸå§‹å†™æ³•&#34;&gt;âŒ åŸå§‹å†™æ³•&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;funcCalled&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Fatalf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;å‡½æ•°å¤ªæ—©è¢«è°ƒç”¨&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;cancel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;funcCalled&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Fatalf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;å‡½æ•°æ²¡åœ¨å–æ¶ˆåè¢«è°ƒç”¨&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;éœ€è¦é€šé“åŒæ­¥æˆ–åŠ é”é¿å…æ•°æ®ç«æ€&lt;/li&gt;
&lt;li&gt;éœ€è¦ &lt;code&gt;time.After()&lt;/code&gt; ç­‰äººä¸ºå»¶æ—¶&lt;/li&gt;
&lt;li&gt;æ…¢ä¸”ä¸ç¨³å®š&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;-ä½¿ç”¨-synctest&#34;&gt;âœ… ä½¿ç”¨ synctest&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;synctest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Run&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;funcCalled&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;AfterFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;funcCalled&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;synctest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Wait&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;funcCalled&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Fatalf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;å‡½æ•°åœ¨å–æ¶ˆå‰è¢«è°ƒç”¨äº†&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;cancel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;synctest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Wait&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;funcCalled&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Fatalf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;å‡½æ•°åœ¨å–æ¶ˆåæ²¡æœ‰è¢«è°ƒç”¨&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;æ— éœ€ sleep æˆ–é€šé“&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;Wait()&lt;/code&gt; è‡ªåŠ¨ç­‰ goroutine é˜»å¡&lt;/li&gt;
&lt;li&gt;å¯è¯»æ€§æ›´å¼ºã€æ— ç«æ€ã€é€Ÿåº¦æ›´å¿«&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-å››æµ‹è¯•æ¶‰åŠæ—¶é—´çš„ä»£ç ä½¿ç”¨è™šæ‹Ÿæ—¶é—´&#34;&gt;â° å››ã€æµ‹è¯•æ¶‰åŠæ—¶é—´çš„ä»£ç ï¼ˆä½¿ç”¨è™šæ‹Ÿæ—¶é—´ï¼‰&lt;/h2&gt;
&lt;p&gt;åœ¨ synctest çš„ bubble ä¸­ï¼ŒGo ä½¿ç”¨&lt;strong&gt;è™šæ‹Ÿæ—¶é—´ï¼ˆfake clockï¼‰&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰€æœ‰ &lt;code&gt;time.Sleep&lt;/code&gt;ã€&lt;code&gt;WithTimeout&lt;/code&gt; éƒ½å˜æˆ&lt;strong&gt;éçœŸå®é˜»å¡&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;æ—¶é—´åªä¼šåœ¨ goroutine å…¨éƒ¨é˜»å¡æ—¶æ¨è¿›&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç¤ºä¾‹æµ‹è¯•-contextwithtimeout&#34;&gt;ç¤ºä¾‹ï¼šæµ‹è¯• &lt;code&gt;context.WithTimeout&lt;/code&gt;&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ns&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;synctest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Wait&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;expect&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ns&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;synctest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Wait&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;expect&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;DeadlineExceeded&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;å°±åƒå†™çœŸæ—¶é—´æµ‹è¯•ä¸€æ ·ç›´è§‚&lt;/li&gt;
&lt;li&gt;å®é™…è¿è¡Œé€Ÿåº¦æå¿«&lt;/li&gt;
&lt;li&gt;ä¸éœ€è¦ä¿®æ”¹ä»£ç æ¥æ”¯æŒ fake clockï¼&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-äº”æ·±å…¥ç†è§£bubble-çš„å·¥ä½œæœºåˆ¶&#34;&gt;ğŸŒ€ äº”ã€æ·±å…¥ç†è§£ï¼šBubble çš„å·¥ä½œæœºåˆ¶&lt;/h2&gt;
&lt;h3 id=&#34;bubble-æ˜¯ä»€ä¹ˆ&#34;&gt;â€œBubbleâ€ æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;Run()&lt;/code&gt; å¯åŠ¨ä¸€ä¸ª goroutineï¼Œåœ¨ä¸€ä¸ªå®Œå…¨&lt;strong&gt;éš”ç¦»çš„ç¯å¢ƒ&lt;/strong&gt;é‡Œè¿è¡Œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿™ä¸ªç¯å¢ƒå« â€œbubbleâ€&lt;/li&gt;
&lt;li&gt;é‡Œé¢çš„ goroutine ä¹‹é—´æ˜¯ç‹¬ç«‹çš„&lt;/li&gt;
&lt;li&gt;å¤–ç•Œæ— æ³•å¹²æ‰°å®ƒä»¬&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;wait-çš„åŸç†&#34;&gt;&lt;code&gt;Wait()&lt;/code&gt; çš„åŸç†&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç­‰å¾… bubble ä¸­&lt;strong&gt;æ‰€æœ‰ goroutine éƒ½é˜»å¡&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;é˜»å¡æ¡ä»¶å¿…é¡»æ˜¯â€œè€ä¹…é˜»å¡â€ (durably blocked)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯-durably-blocked&#34;&gt;ä»€ä¹ˆæ˜¯ durably blockedï¼Ÿ&lt;/h3&gt;
&lt;p&gt;åªæœ‰ä»¥ä¸‹æƒ…å†µï¼Œgoroutine æ‰è¢«è®¤ä¸ºâ€œè€ä¹…é˜»å¡â€ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ nil é€šé“ä¸Šæ”¶å‘&lt;/li&gt;
&lt;li&gt;åœ¨ bubble å†…çš„ channel ä¸Šé˜»å¡&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰ select åˆ†æ”¯éƒ½é˜»å¡&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sync.WaitGroup.Wait&lt;/code&gt;ã€&lt;code&gt;sync.Cond.Wait&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;time.Sleep&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;-ä»¥ä¸‹æƒ…å†µä¸ä¼šè§†ä¸ºè€ä¹…é˜»å¡&#34;&gt;âŒ ä»¥ä¸‹æƒ…å†µ&lt;strong&gt;ä¸ä¼š&lt;/strong&gt;è§†ä¸ºè€ä¹…é˜»å¡&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;sync.Mutexï¼ˆå¯èƒ½ä¼šè¢« bubble å¤–çš„ goroutine è§£é”ï¼‰&lt;/li&gt;
&lt;li&gt;å¤–éƒ¨ç½‘ç»œæˆ– I/O&lt;/li&gt;
&lt;li&gt;ä¸ bubble å¤–é€šä¿¡çš„ channel&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-å…­å¤„ç†-ioç½‘ç»œchannel&#34;&gt;ğŸ“¦ å…­ã€å¤„ç† I/Oã€ç½‘ç»œã€channel&lt;/h2&gt;
&lt;h3 id=&#34;channel-ä½¿ç”¨è§„åˆ™&#34;&gt;â—Channel ä½¿ç”¨è§„åˆ™&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åªæœ‰ &lt;strong&gt;åœ¨ bubble å†…åˆ›å»ºçš„ channel&lt;/strong&gt; æ‰èƒ½ç”¨äºåŒæ­¥&lt;/li&gt;
&lt;li&gt;ä»å¤–éƒ¨è®¿é—® bubble å†… channel ä¼š panicï¼ˆé˜²æ­¢æ„å¤–ç«äº‰ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç½‘ç»œå’Œ-io-ä¸è¢«è§†ä¸ºè€ä¹…é˜»å¡&#34;&gt;â—ç½‘ç»œå’Œ I/O ä¸è¢«è§†ä¸ºè€ä¹…é˜»å¡&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç½‘ç»œæ•°æ®å¯èƒ½æ¥è‡ª bubble å¤–éƒ¨ï¼ˆç”šè‡³æ˜¯å…¶ä»–è¿›ç¨‹ï¼‰&lt;/li&gt;
&lt;li&gt;æ— æ³•ä¿è¯å®‰å…¨æ€§ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç”¨ Wait åŒæ­¥&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;-æ¨èæ–¹å¼&#34;&gt;âœ… æ¨èæ–¹å¼&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;net.Pipe()&lt;/code&gt; æ¥åˆ›å»º&lt;strong&gt;å†…å­˜ä¸­ fake ç½‘ç»œè¿æ¥&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-ä¸ƒç½‘ç»œæµ‹è¯•ç¤ºä¾‹expect-100-continue&#34;&gt;ğŸŒ ä¸ƒã€ç½‘ç»œæµ‹è¯•ç¤ºä¾‹ï¼šExpect: 100-continue&lt;/h2&gt;
&lt;p&gt;HTTP ä¸­ &lt;code&gt;Expect: 100-continue&lt;/code&gt; çš„è¡Œä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®¢æˆ·ç«¯å…ˆå‘ headerï¼Œç­‰æœåŠ¡å™¨è¿”å› 100 Continue å†å‘ body&lt;/li&gt;
&lt;li&gt;æµ‹è¯•è¦ç¡®ä¿æ²¡æœ‰æå‰å‘ body&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æµ‹è¯•æµç¨‹&#34;&gt;æµ‹è¯•æµç¨‹&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ç”¨ &lt;code&gt;net.Pipe&lt;/code&gt; åˆ›å»º server/client çš„å†…å­˜è¿æ¥&lt;/li&gt;
&lt;li&gt;è®¾ç½® &lt;code&gt;http.Transport&lt;/code&gt; ç”¨è¿™ä¸ªè¿æ¥&lt;/li&gt;
&lt;li&gt;å¯åŠ¨ goroutine å‘è¯·æ±‚&lt;/li&gt;
&lt;li&gt;æ‹¿åˆ°è¯·æ±‚å¤´ä¹‹åï¼Œä¸å‘ 100 Continueï¼Œæ£€æŸ¥ body æ²¡æœ‰å‘&lt;/li&gt;
&lt;li&gt;å‘ 100 Continue å“åº”&lt;/li&gt;
&lt;li&gt;ç­‰å¾…ï¼ŒéªŒè¯ body è¢«å‘å‡º&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;ä½¿ç”¨-synctest&#34;&gt;ä½¿ç”¨ synctest&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;go&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Copy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;gotBody&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;req&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;synctest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Wait&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;assert&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;gotBody&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// æ²¡æå‰å‘ body
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;srvConn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;HTTP/1.1 100 Continue\r\n\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;synctest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Wait&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;assert&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;gotBody&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// æ”¶åˆ° Continue åæ‰å‘
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h2 id=&#34;-å…«ä½¿ç”¨é¡»çŸ¥ä¸å®éªŒçŠ¶æ€&#34;&gt;ğŸš§ å…«ã€ä½¿ç”¨é¡»çŸ¥ä¸å®éªŒçŠ¶æ€&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;testing/synctest&lt;/code&gt; æ˜¯ &lt;strong&gt;å®éªŒæ€§&lt;/strong&gt; åŒ…&lt;/li&gt;
&lt;li&gt;é»˜è®¤ä¸å¯è§ï¼Œéœ€å¼€å¯å®éªŒç‰¹æ€§ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;GOEXPERIMENT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;synctest go &lt;span class=&#34;nb&#34;&gt;test&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;API æœªæ¥å¯èƒ½å˜åŠ¨æˆ–è¢«ç§»é™¤&lt;/li&gt;
&lt;li&gt;æ¬¢è¿é€šè¿‡ &lt;a href=&#34;https://go.dev/issue/67434&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;go.dev/issue/67434&lt;/a&gt; æä¾›åé¦ˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-æ€»ç»“è¡¨æ ¼&#34;&gt;âœ… æ€»ç»“è¡¨æ ¼&lt;/h2&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;ç‰¹æ€§&lt;/th&gt;
          &lt;th&gt;åŸæ¥&lt;/th&gt;
          &lt;th&gt;ä½¿ç”¨ synctest&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;æ—¶é—´æ§åˆ¶&lt;/td&gt;
          &lt;td&gt;ç”¨ sleep æ¨¡æ‹Ÿ&lt;/td&gt;
          &lt;td&gt;è™šæ‹Ÿæ—¶é—´è‡ªåŠ¨æ¨è¿›&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;å¹¶å‘åŒæ­¥&lt;/td&gt;
          &lt;td&gt;é€šé“ / é”&lt;/td&gt;
          &lt;td&gt;è‡ªåŠ¨ Wait&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;ç¨³å®šæ€§&lt;/td&gt;
          &lt;td&gt;flaky&lt;/td&gt;
          &lt;td&gt;ç¨³å®šã€æ—  race&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;æµ‹è¯•é€Ÿåº¦&lt;/td&gt;
          &lt;td&gt;æ…¢&lt;/td&gt;
          &lt;td&gt;éå¸¸å¿«&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;å¯è¯»æ€§&lt;/td&gt;
          &lt;td&gt;ä½&lt;/td&gt;
          &lt;td&gt;æ¸…æ™°ä¼˜é›…&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;é€‚ç”¨åœºæ™¯&lt;/td&gt;
          &lt;td&gt;éš¾æµ‹ä»£ç éœ€é‡æ„&lt;/td&gt;
          &lt;td&gt;å¯ç›´æ¥æµ‹è¯•ç°æœ‰å¹¶å‘ä»£ç &lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;p&gt;å¦‚æœä½ éœ€è¦ï¼Œæˆ‘å¯ä»¥ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¸®ä½ å†™ä¸€ä¸ªä½¿ç”¨ &lt;code&gt;synctest&lt;/code&gt; çš„æµ‹è¯•æ ·ä¾‹&lt;/li&gt;
&lt;li&gt;ç»™ä½ ä»£ç é‡æ„å»ºè®®ï¼Œå¦‚ä½•ä»æ—§çš„ channel-based æµ‹è¯•è¿ç§»åˆ° synctest&lt;/li&gt;
&lt;li&gt;æˆ–è€…åˆ†æä½ å·²æœ‰æµ‹è¯•ï¼Œçœ‹çœ‹å¦‚ä½•ç®€åŒ–å®ƒ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¦ä¸è¦è¯•è¯•ï¼Ÿ&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Goodbye core types-Hello Go as we know and love it!</title>
      <link>http://localhost:1313/post/20250328/</link>
      <pubDate>Fri, 28 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/20250328/</guid>
      <description>&lt;h2 id=&#34;-ä¸€ç†è§£èƒŒæ™¯goè¯­è¨€æ³›å‹genericsçš„å¼•å…¥&#34;&gt;ğŸ“Œ ä¸€ã€ç†è§£èƒŒæ™¯ï¼šGoè¯­è¨€æ³›å‹ï¼ˆGenericsï¼‰çš„å¼•å…¥&lt;/h2&gt;
&lt;p&gt;åœ¨ Go 1.18ï¼ˆ2022å¹´3æœˆå‘å¸ƒï¼‰ä»¥å‰ï¼ŒGoè¯­è¨€å¹¶æ²¡æœ‰æ³›å‹åŠŸèƒ½ï¼ˆgenericsï¼‰ã€‚æ‰€è°“&lt;strong&gt;æ³›å‹&lt;/strong&gt;å°±æ˜¯å†™å‡½æ•°æˆ–æ•°æ®ç»“æ„æ—¶ï¼Œå¯ä»¥ä¸æŒ‡å®šå…·ä½“ç±»å‹ï¼Œè€Œç”¨&lt;strong&gt;ç±»å‹å‚æ•°&lt;/strong&gt;ä»£æ›¿ï¼Œç„¶åè°ƒç”¨æ—¶å†å¡«å…¥å…·ä½“ç±»å‹ï¼Œè¿™æ ·å‡½æ•°å¯ä»¥ç”¨äºå¾ˆå¤šä¸åŒç±»å‹çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// æ²¡æœ‰æ³›å‹ä¹‹å‰ï¼Œå¾—ä¸ºæ¯ç§ç±»å‹å†™ä¸€ä¸ªå‡½æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;SumInt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;SumFloat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;float64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;float64&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// æ³›å‹åï¼Œå¯ä»¥åªå†™ä¸€ä¸ªå‡½æ•°ï¼š
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Sum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;T&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;float64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;](&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;T&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ³›å‹çš„å¼•å…¥ä½¿Goè¯­è¨€æ›´çµæ´»ã€æ›´å¼ºå¤§ã€‚ä½†éšä¹‹è€Œæ¥ï¼Œè¯­è¨€å†…éƒ¨å®ç°å˜å¾—å¤æ‚äº†ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-äºŒç†è§£ç±»å‹å‚æ•°ç±»å‹çº¦æŸå’Œç±»å‹é›†&#34;&gt;ğŸ“Œ äºŒã€ç†è§£ç±»å‹å‚æ•°ã€ç±»å‹çº¦æŸå’Œç±»å‹é›†&lt;/h2&gt;
&lt;p&gt;æ³›å‹ä¸­å‡ºç°äº†ä¸€äº›é‡è¦æ¦‚å¿µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h3 id=&#34;ç±»å‹å‚æ•°type-parameter&#34;&gt;&lt;strong&gt;ç±»å‹å‚æ•°ï¼ˆType Parameterï¼‰&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;å°±æ˜¯æ³›å‹å‡½æ•°æˆ–æ³›å‹ç»“æ„ä½“ä¸­ç”¨æ¥ä»£æ›¿å…·ä½“ç±»å‹çš„å ä½ç¬¦ï¼Œç±»ä¼¼å‡½æ•°å‚æ•°ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Example&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;T&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;](&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;T&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é‡Œ&lt;code&gt;T&lt;/code&gt;å°±æ˜¯ä¸€ä¸ªç±»å‹å‚æ•°ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;h3 id=&#34;ç±»å‹çº¦æŸtype-constraint&#34;&gt;&lt;strong&gt;ç±»å‹çº¦æŸï¼ˆType Constraintï¼‰&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;è¡¨ç¤ºä¸€ä¸ªç±»å‹å‚æ•°èƒ½å–å“ªäº›å…·ä½“ç±»å‹çš„é™åˆ¶ã€‚ç”¨æ¥å£è¡¨ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;MyConstraint&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;~[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;Hash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;uint64&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªçº¦æŸè¡¨ç¤ºä»»ä½•åº•å±‚ç±»å‹æ˜¯&lt;code&gt;string&lt;/code&gt;æˆ–&lt;code&gt;[]byte&lt;/code&gt;ï¼Œå¹¶ä¸”å®ç°äº†&lt;code&gt;Hash()&lt;/code&gt;æ–¹æ³•çš„ç±»å‹éƒ½å¯ä»¥æ»¡è¶³ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;h3 id=&#34;ç±»å‹é›†type-set&#34;&gt;&lt;strong&gt;ç±»å‹é›†ï¼ˆType Setï¼‰&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;ä¸€ä¸ªç±»å‹çº¦æŸå®šä¹‰äº†ä¸€ç»„æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„ç±»å‹é›†åˆï¼Œç§°ä¸ºâ€œç±»å‹é›†â€ã€‚ä¸Šè¿°ä¾‹å­ä¸­ï¼Œç±»å‹é›†å°±æ˜¯æ»¡è¶³â€œåº•å±‚ç±»å‹æ˜¯&lt;code&gt;string&lt;/code&gt;æˆ–&lt;code&gt;[]byte&lt;/code&gt;ä¸”å¸¦æœ‰&lt;code&gt;Hash()&lt;/code&gt;æ–¹æ³•â€çš„æ‰€æœ‰ç±»å‹çš„é›†åˆã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-ä¸‰æ ¸å¿ƒç±»å‹core-typeåˆ°åº•æ˜¯ä»€ä¹ˆ&#34;&gt;ğŸ“Œ ä¸‰ã€â€œæ ¸å¿ƒç±»å‹â€ï¼ˆCore Typeï¼‰åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å¼•å…¥æ³›å‹ä¹‹åï¼ŒGoçš„å®ç°è€…å‘ç°äº†ä¸€ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»¥å‰è¯­è¨€è§„èŒƒé‡Œï¼Œå¾ˆå¤šæ“ä½œï¼ˆæ¯”å¦‚&lt;code&gt;close&lt;/code&gt;ã€&lt;code&gt;append&lt;/code&gt;ã€åˆ‡ç‰‡æ“ä½œï¼‰éƒ½æ˜¯ç›´æ¥è¯´ï¼šâ€œå‚æ•°å¿…é¡»æ˜¯é€šé“â€ã€â€œå‚æ•°å¿…é¡»æ˜¯åˆ‡ç‰‡æˆ–æ•°ç»„â€ã€‚&lt;br&gt;
ä½†æ³›å‹å‡ºç°åï¼Œæœ‰äº›æ“ä½œçš„å‚æ•°å¯èƒ½æ˜¯&lt;strong&gt;ç±»å‹å‚æ•°&lt;/strong&gt;ï¼Œæ— æ³•ç›´æ¥è¯´æ¸…æ¥šå…·ä½“ç±»å‹äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¯­è¨€è§„èŒƒå¼•å…¥äº†ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œç§°ä¸º&lt;strong&gt;æ ¸å¿ƒç±»å‹ï¼ˆcore typeï¼‰&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ ¸å¿ƒç±»å‹çš„å®šä¹‰å¤§è‡´æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;éæ³›å‹æƒ…å†µ&lt;/strong&gt;ï¼šæŸä¸ªæ™®é€šç±»å‹çš„æ ¸å¿ƒç±»å‹å°±æ˜¯å®ƒçš„&lt;strong&gt;åº•å±‚ç±»å‹ï¼ˆunderlying typeï¼‰&lt;/strong&gt;ã€‚&lt;br&gt;
æ¯”å¦‚ï¼š&lt;code&gt;type MyInt int&lt;/code&gt; çš„æ ¸å¿ƒç±»å‹å°±æ˜¯&lt;code&gt;int&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ³›å‹æƒ…å†µ&lt;/strong&gt;ï¼šè‹¥ç±»å‹å‚æ•°çš„ç±»å‹é›†ä¸­çš„&lt;strong&gt;æ‰€æœ‰ç±»å‹çš„åº•å±‚ç±»å‹éƒ½å®Œå…¨ä¸€æ ·&lt;/strong&gt;ï¼Œåˆ™è¿™ä¸ªç±»å‹å‚æ•°çš„æ ¸å¿ƒç±»å‹å°±æ˜¯é‚£ä¸ªå…±åŒçš„åº•å±‚ç±»å‹ã€‚&lt;br&gt;
åä¹‹ï¼Œå¦‚æœç±»å‹é›†ä¸­æœ‰ä¸åŒçš„åº•å±‚ç±»å‹ï¼Œåˆ™ä¸å­˜åœ¨æ ¸å¿ƒç±»å‹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;interface{ ~[]int }&lt;/code&gt;ç±»å‹é›†åªæœ‰ä¸€ç§åº•å±‚ç±»å‹ï¼ˆ&lt;code&gt;[]int&lt;/code&gt;ï¼‰ï¼Œå› æ­¤å®ƒçš„æ ¸å¿ƒç±»å‹å°±æ˜¯&lt;code&gt;[]int&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;interface{ ~[]byte | ~string }&lt;/code&gt;å­˜åœ¨ä¸¤ç§ä¸åŒçš„åº•å±‚ç±»å‹ï¼ˆ&lt;code&gt;[]byte&lt;/code&gt;å’Œ&lt;code&gt;string&lt;/code&gt;ï¼‰ï¼Œå› æ­¤è¿™ä¸ªæ¥å£ä¸å­˜åœ¨æ ¸å¿ƒç±»å‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€åˆå¼•å…¥æ ¸å¿ƒç±»å‹çš„åŸå› å¾ˆç®€å•ï¼šå°±æ˜¯ä¸ºäº†è¯­è¨€è§„èŒƒæ–¹ä¾¿å™è¿°å’Œç¼–è¯‘å™¨æ–¹ä¾¿å®ç°ï¼Œé¿å…å¤„ç†æ³›å‹å‚æ•°æ—¶æ€»æ˜¯è€ƒè™‘ä¸€å †ç±»å‹çš„é›†åˆã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-å››æ ¸å¿ƒç±»å‹å­˜åœ¨çš„é—®é¢˜ä¸ºä½•è¦å»æ‰&#34;&gt;ğŸ“Œ å››ã€æ ¸å¿ƒç±»å‹å­˜åœ¨çš„é—®é¢˜ï¼ˆä¸ºä½•è¦å»æ‰ï¼Ÿï¼‰&lt;/h2&gt;
&lt;p&gt;è™½ç„¶æ ¸å¿ƒç±»å‹åˆè¡·æ˜¯ä¸ºäº†ç®€åŒ–æ³›å‹çš„å®ç°ï¼Œä½†å®é™…ä½¿ç”¨ä¸­å´å¸¦æ¥äº†ä¸€äº›æ–°é—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é—®é¢˜1ï¼šè§„åˆ™è¿‡äºä¸¥æ ¼ï¼Œé™åˆ¶äº†è¯­è¨€æ‰©å±•&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å› ä¸ºæ ¸å¿ƒç±»å‹è¦æ±‚ç±»å‹é›†ä¸­æ‰€æœ‰ç±»å‹å¿…é¡»æœ‰&lt;strong&gt;ç›¸åŒçš„åº•å±‚ç±»å‹&lt;/strong&gt;ï¼Œå¾ˆå¤šåˆç†çš„æ³›å‹æ“ä½œåè€Œè¢«ç¦æ­¢äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œä¸‹é¢çš„çº¦æŸå°±æ— æ³•è·å¾—æ ¸å¿ƒç±»å‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Constraint&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;~[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;Hash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;uint64&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ ·ï¼Œä½¿ç”¨æ³›å‹å‚æ•°æ—¶ï¼Œè™½ç„¶ç›´è§‚ä¸Šå¯¹å­—ç¬¦ä¸²å’Œå­—èŠ‚æ•°ç»„çš„æŸäº›æ“ä½œç±»ä¼¼ï¼Œä½†åœ¨æ ¸å¿ƒç±»å‹çš„ä¸¥æ ¼è¦æ±‚ä¸‹æ— æ³•å®ç°ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é—®é¢˜2ï¼šå¢åŠ äº†è¯­è¨€å¤æ‚æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¾ˆå¤šç®€å•çš„æ“ä½œï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// ä»¥å‰åªè¦æ±‚ ch æ˜¯ channel å³å¯
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨è§„èŒƒé‡Œå´å˜æˆäº†ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;â€œå‚æ•°çš„&lt;strong&gt;æ ¸å¿ƒç±»å‹&lt;/strong&gt;å¿…é¡»æ˜¯é€šé“ç±»å‹â€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™è®©æ™®é€šçš„ç¨‹åºå‘˜åœ¨å­¦ä¹ å’Œç†è§£&lt;strong&gt;éæ³›å‹&lt;/strong&gt;ä»£ç æ—¶ï¼Œä¹Ÿéœ€è¦ç†è§£è¿™ä¸ªæŠ½è±¡è€Œå¤æ‚çš„â€œæ ¸å¿ƒç±»å‹â€æ¦‚å¿µï¼Œç»™è¯­è¨€çš„å­¦ä¹ é€ æˆè´Ÿæ‹…ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é—®é¢˜3ï¼šå¯¼è‡´äº†è§„åˆ™çš„ä¸ç»Ÿä¸€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å› ä¸ºå­˜åœ¨æ ¸å¿ƒç±»å‹çš„æ¦‚å¿µï¼ŒæŸäº›æ­£å¸¸çš„æ“ä½œåè€Œæˆä¸ºäº†è¯­è¨€è§„èŒƒçš„â€œç‰¹ä¾‹â€ï¼Œæ¯”å¦‚&lt;code&gt;len()&lt;/code&gt;ã€&lt;code&gt;cap()&lt;/code&gt;ã€ç´¢å¼•æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§ä¸ç»Ÿä¸€æ€§ï¼Œåè€Œä½¿å¾—è¯­è¨€å˜å¾—æ›´éš¾æ‡‚ã€æ›´éš¾ç»´æŠ¤ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å› æ­¤ï¼Œæ ¸å¿ƒç±»å‹åœ¨å®è·µä¸­å˜æˆäº†ä¸€ä¸ªâ€œé¸¡è‚‹â€ï¼Œä¸ä»…æ²¡æœ‰çœŸæ­£è®©è¯­è¨€å˜ç®€å•ï¼Œåè€Œå˜å¤æ‚äº†ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-äº”go-125-åšå‡ºäº†å“ªäº›æ”¹å˜&#34;&gt;ğŸ“Œ äº”ã€Go 1.25 åšå‡ºäº†å“ªäº›æ”¹å˜ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;åŸºäºä»¥ä¸Šé—®é¢˜ï¼ŒGoè¯­è¨€å¼€å‘å›¢é˜Ÿåœ¨å³å°†åˆ°æ¥çš„&lt;strong&gt;Go 1.25ï¼ˆ2025å¹´8æœˆï¼‰&lt;strong&gt;ä¸­å†³å®šå½»åº•&lt;/strong&gt;åºŸå¼ƒâ€œæ ¸å¿ƒç±»å‹â€æ¦‚å¿µ&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç›´æ¥åˆ æ‰äº†æ ¸å¿ƒç±»å‹çš„å®šä¹‰&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è§„èŒƒä¸­çš„æ¯ä¸ªæ“ä½œï¼Œå›åˆ°æ›´ç›´æ¥çš„è¡¨è¿°æ–¹å¼ï¼š&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ï¼ŒåŸæ¥ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;â€œcloseå‡½æ•°çš„å‚æ•°æ ¸å¿ƒç±»å‹å¿…é¡»æ˜¯é€šé“â€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç°åœ¨æ¢å¤ä¸ºï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;â€œcloseå‡½æ•°çš„å‚æ•°å¿…é¡»æ˜¯é€šé“â€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é’ˆå¯¹æ³›å‹æƒ…å†µä¸‹ï¼Œè§„èŒƒå¢åŠ é¢å¤–ä½†ç›´æ¥æ˜ç¡®çš„è¯´æ˜ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;â€œè‹¥closeå‡½æ•°çš„å‚æ•°æ˜¯ç±»å‹å‚æ•°ï¼Œåˆ™ç±»å‹é›†å†…æ‰€æœ‰ç±»å‹å¿…é¡»ä¸ºå…ƒç´ ç±»å‹ä¸€è‡´çš„é€šé“ç±»å‹ã€‚â€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å®é™…æ•ˆæœæ˜¯&#34;&gt;å®é™…æ•ˆæœæ˜¯&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¯­è¨€è§„èŒƒå˜ç®€å•äº†&lt;/strong&gt;ï¼šæ™®é€šç¨‹åºå‘˜ä¸å†éœ€è¦ç†è§£æŠ½è±¡çš„â€œæ ¸å¿ƒç±»å‹â€ï¼Œè¯­è¨€å›å½’ç›´è§‚å’Œç®€å•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éæ³›å‹ä»£ç å›å½’åŸæ ·&lt;/strong&gt;ï¼šä¸ç”¨å†å…³å¿ƒæ³›å‹ç›¸å…³çš„æ¦‚å¿µï¼Œæ“ä½œçš„å«ä¹‰å˜å¾—ç›´æ¥æ˜“æ‡‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³›å‹æ“ä½œæ›´çµæ´»&lt;/strong&gt;ï¼šæœªæ¥å¯ä»¥æ›´çµæ´»åœ°æ‹“å±•ï¼Œæ¯”å¦‚å…è®¸æ›´ä¸°å¯Œçš„ç±»å‹æ“ä½œï¼Œä¸å†å—æ ¸å¿ƒç±»å‹æ¦‚å¿µçš„é™åˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-å…­æ€»ç»“ä¸ç›´è§‚ç†è§£&#34;&gt;ğŸ“Œ å…­ã€æ€»ç»“ä¸ç›´è§‚ç†è§£&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ³›å‹å¼•å…¥å&lt;/strong&gt; â†’ ä¸ºäº†æ–¹ä¾¿æè¿° â†’ å‡ºç°äº†â€œæ ¸å¿ƒç±»å‹â€&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®é™…ä½¿ç”¨åå‘ç°&lt;/strong&gt; â†’ æ ¸å¿ƒç±»å‹ä¸ä»…æ²¡ç®€åŒ–ï¼Œåè€Œå¸¦æ¥äº†å¤æ‚æ€§&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Go 1.25å†³å®š&lt;/strong&gt; â†’ åˆ æ‰â€œæ ¸å¿ƒç±»å‹â€ï¼Œå›å½’ç®€å•ç›´æ¥çš„è¯­è¨€è®¾è®¡æ–¹å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç®€å•æ¥è¯´ï¼Œ&lt;strong&gt;æ ¸å¿ƒç±»å‹&lt;/strong&gt;åŸæœ¬æ˜¯ä¸ºäº†è§£å†³æ³›å‹å®ç°ä¸­é‡åˆ°çš„é—®é¢˜ï¼Œä½†å®é™…å¸¦æ¥äº†æ›´å¤§çš„å¤æ‚æ€§ã€‚Goå›¢é˜Ÿå†³å®šâ€œå›åˆ°åˆå¿ƒâ€ï¼Œå–æ¶ˆè¿™ä¸ªæ¦‚å¿µï¼Œè®©è¯­è¨€è§„èŒƒæ›´åŠ æ˜“æ‡‚ï¼Œæ›´ä¾¿äºæœªæ¥æ‰©å±•ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ å·²ç»å®Œå…¨ç†è§£äº†è¿™ç¯‡æ–‡ç« çš„æ¥é¾™å»è„‰ä»¥åŠä¸ºä½• Go å†³å®šåºŸå¼ƒâ€œæ ¸å¿ƒç±»å‹â€çš„åŸå› ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Traversal-resistant file APIs</title>
      <link>http://localhost:1313/post/202503282138/</link>
      <pubDate>Fri, 28 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/202503282138/</guid>
      <description>&lt;h2 id=&#34;-ä¸€è·¯å¾„éå†æ”»å‡»æ˜¯ä»€ä¹ˆ&#34;&gt;ğŸ“Œ ä¸€ã€è·¯å¾„éå†æ”»å‡»æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;è·¯å¾„éå†ï¼ˆPath Traversalï¼‰æ”»å‡»æ˜¯ä¸€ç§å®‰å…¨æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ§åˆ¶ç¨‹åºè®¿é—®æ–‡ä»¶çš„è·¯å¾„ï¼Œä½¿ç¨‹åºæ‰“å¼€äº†åŸæœ¬&lt;strong&gt;æœªæˆæƒè®¿é—®&lt;/strong&gt;çš„æ•æ„Ÿæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-äºŒå…¸å‹æ¼æ´ç¤ºä¾‹æ˜“å—æ”»å‡»çš„ä»£ç &#34;&gt;ğŸ“Œ äºŒã€å…¸å‹æ¼æ´ç¤ºä¾‹ï¼ˆæ˜“å—æ”»å‡»çš„ä»£ç ï¼‰&lt;/h2&gt;
&lt;p&gt;å­˜åœ¨æ¼æ´çš„ä»£ç é€šå¸¸é•¿è¿™æ ·ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// baseDirectory æ˜¯å—ä¿¡ä»»çš„å›ºå®šç›®å½•
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// filename æ˜¯ç”¨æˆ·å¯æ§åˆ¶çš„è¾“å…¥
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;filepath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;baseDirectory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;ä¸ºä»€ä¹ˆè¿™æ®µä»£ç æœ‰æ¼æ´ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å‡è®¾ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;baseDirectory&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;/var/www/data&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;filename&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;../../../../etc/passwd&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‰§è¡Œåï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;filepath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/var/www/data&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;../../../../etc/passwd&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// å®é™…è·¯å¾„ï¼š&amp;#34;/etc/passwd&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ”»å‡»è€…æˆåŠŸè·³å‡ºäº†æœ¬æ¥é™å®šçš„ç›®å½•ï¼ˆ&lt;code&gt;/var/www/data&lt;/code&gt;ï¼‰ï¼Œè®¿é—®åˆ°äº†æ•æ„Ÿæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-ä¸‰ä¸ºä»€ä¹ˆä¼ ç»Ÿè·¯å¾„æ£€æŸ¥ä¸å¤Ÿå®‰å…¨&#34;&gt;ğŸ“Œ ä¸‰ã€ä¸ºä»€ä¹ˆä¼ ç»Ÿè·¯å¾„æ£€æŸ¥ä¸å¤Ÿå®‰å…¨ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä½ å¯èƒ½ä¼šæƒ³è‡ªå·±æ‰‹åŠ¨éªŒè¯ï¼Œæ¯”å¦‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// æ‰‹åŠ¨æ£€æŸ¥è·¯å¾„å®‰å…¨æ€§ï¼ˆä¸æ¨èï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;strings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Contains&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;..&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;errors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;New&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;è·¯å¾„ä¸å®‰å…¨&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;filepath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;baseDirectory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½†è¿™ç§æ£€æŸ¥æ–¹å¼&lt;strong&gt;ä¸å®‰å…¨&lt;/strong&gt;ï¼ŒåŸå› å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ˜“è¢«ç»•è¿‡&lt;/strong&gt;ï¼šå¤æ‚è·¯å¾„ç»„åˆï¼ˆå¦‚&lt;code&gt;..././../&lt;/code&gt;ï¼‰æˆ–ç»å¯¹è·¯å¾„éš¾ä»¥å®Œå…¨è¦†ç›–ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è·¨å¹³å°é—®é¢˜&lt;/strong&gt;ï¼šWindows å’Œ Unix/Linux ç³»ç»Ÿå¯¹è·¯å¾„çš„ç†è§£ä¸åŒï¼ŒWindows è¿˜æ¶‰åŠç‰¹æ®Šè®¾å¤‡åï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;TOCTOUæ”»å‡»&lt;/strong&gt;ï¼š&lt;br&gt;
æ”»å‡»è€…å¯ä»¥åœ¨ä½ çš„æ£€æŸ¥å®Œæˆåã€ç¨‹åºçœŸæ­£æ‰“å¼€æ–‡ä»¶ä¹‹å‰ï¼Œé€šè¿‡ä¿®æ”¹ç¬¦å·é“¾æ¥æˆ–è·¯å¾„ç»“æ„ï¼Œä»æ—§ç»•è¿‡æ£€æŸ¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-å››go-124-æä¾›çš„å®‰å…¨æ–¹æ¡ˆosroot--osopeninroot&#34;&gt;ğŸ“Œ å››ã€Go 1.24 æä¾›çš„å®‰å…¨æ–¹æ¡ˆï¼š&lt;code&gt;os.Root&lt;/code&gt; / &lt;code&gt;os.OpenInRoot&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;ä¸ºå½»åº•è§£å†³ä¸Šè¿°é—®é¢˜ï¼ŒGo 1.24 æ¨å‡ºäº†æ–°çš„ APIï¼š&lt;/p&gt;
&lt;p&gt;å®‰å…¨ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// å®‰å…¨çš„ä»£ç ï¼Œå½»åº•é˜²æ­¢è·¯å¾„é€ƒé€¸
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;OpenInRoot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;baseDirectory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;å®ƒä¸ºä»€ä¹ˆå®‰å…¨&#34;&gt;å®ƒä¸ºä»€ä¹ˆå®‰å…¨ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;os.OpenInRoot&lt;/code&gt; å†…éƒ¨æœºåˆ¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¦–å…ˆæ‰“å¼€å¹¶é”å®šæ ¹ç›®å½•ï¼ˆå¦‚&lt;code&gt;/var/www/data&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;è‡ªåŠ¨æ£€æŸ¥ç”¨æˆ·æä¾›çš„è·¯å¾„ï¼Œ&lt;strong&gt;ç»ä¸å…è®¸&lt;/strong&gt;è·¯å¾„é€ƒé€¸ï¼ˆå¦‚é€šè¿‡&lt;code&gt;../&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨å¹³å°åŸç”ŸAPIï¼ˆå¦‚Unix/Linux çš„&lt;code&gt;openat&lt;/code&gt;ï¼‰é˜²æ­¢ç¬¦å·é“¾æ¥æ”»å‡»ï¼›&lt;/li&gt;
&lt;li&gt;Windows å¹³å°é˜²æ­¢ç‰¹æ®Šè®¾å¤‡åè®¿é—®ï¼Œå¦‚&lt;code&gt;COM1&lt;/code&gt;ã€&lt;code&gt;NUL&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-äº”å¹³å°å·®å¼‚å’Œæ³¨æ„äº‹é¡¹&#34;&gt;ğŸ“Œ äº”ã€å¹³å°å·®å¼‚å’Œæ³¨æ„äº‹é¡¹&lt;/h2&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å¹³å°&lt;/th&gt;
          &lt;th&gt;è¯´æ˜&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;Unix/Linux&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;ç”¨&lt;code&gt;openat&lt;/code&gt;ç³»ç»Ÿè°ƒç”¨é˜²æ­¢é€ƒé€¸ï¼Œä½†æ— æ³•é˜»æ­¢rootç”¨æˆ·åˆ›å»ºçš„æŒ‚è½½ç‚¹ï¼ˆå¦‚bind mountï¼‰æ”»å‡»ã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;Windows&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;é€šè¿‡å¥æŸ„é”å®šç›®å½•ï¼Œé˜»æ­¢ç›®å½•è¢«é‡å‘½åæˆ–åˆ é™¤ï¼›ç¦æ­¢è®¿é—®ç‰¹æ®Šè®¾å¤‡åã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;WASI&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;å®‰å…¨æ€§å–å†³äºWASIå®ç°çš„æ²™ç®±ç‰¹æ€§ã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;GOOS=js (Node.jsç¯å¢ƒ)&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;æ— æ³•æœ‰æ•ˆæŠµå¾¡TOCTOUæ”»å‡»ï¼Œå› ä¸ºç¼ºå°‘&lt;code&gt;openat&lt;/code&gt;å‡½æ•°ã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;strong&gt;Plan 9&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;æ²¡æœ‰ç¬¦å·é“¾æ¥ï¼Œç›´æ¥è¿›è¡Œè·¯å¾„è¯æ³•æ£€æŸ¥ã€‚&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-å…­æ€§èƒ½é—®é¢˜ä¸ä¼˜åŒ–&#34;&gt;ğŸ“Œ å…­ã€æ€§èƒ½é—®é¢˜ä¸ä¼˜åŒ–&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;os.Root&lt;/code&gt;æˆ–&lt;code&gt;os.OpenInRoot&lt;/code&gt;å¤„ç†å¤æ‚è·¯å¾„ï¼ˆå¤§é‡&lt;code&gt;../&lt;/code&gt;ï¼‰æ•ˆç‡ç¨ä½ï¼›&lt;/li&gt;
&lt;li&gt;å»ºè®®æå‰ä½¿ç”¨&lt;code&gt;filepath.Clean&lt;/code&gt;æ¸…ç†è·¯å¾„æ¥æé«˜æ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-ä¸ƒä»€ä¹ˆæ—¶å€™å¿…é¡»ä½¿ç”¨-osroot&#34;&gt;ğŸ“Œ ä¸ƒã€ä»€ä¹ˆæ—¶å€™å¿…é¡»ä½¿ç”¨ &lt;code&gt;os.Root&lt;/code&gt;ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;æ»¡è¶³ä»¥ä¸‹æ¡ä»¶å¿…é¡»ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½ è¦æ‰“å¼€çš„æ–‡ä»¶&lt;strong&gt;ä½äºæŸä¸ªæŒ‡å®šçš„æ ¹ç›®å½•å†…&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;li&gt;æ–‡ä»¶è·¯å¾„&lt;strong&gt;æ¥è‡ªå¤–éƒ¨ç”¨æˆ·çš„è¾“å…¥æˆ–ä¸å¯ä¿¡æ¥æº&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è§£å‹zip/taræ–‡ä»¶åˆ°ç‰¹å®šç›®å½•ï¼›&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ï¼Œå¿…é¡»é™åˆ¶åˆ°ç‰¹å®šæ–‡ä»¶å¤¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;-å…«å®Œæ•´æ€»ç»“ä¸å»ºè®®&#34;&gt;ğŸ“Œ å…«ã€å®Œæ•´æ€»ç»“ä¸å»ºè®®&lt;/h2&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;æ–¹å¼&lt;/th&gt;
          &lt;th&gt;æ˜¯å¦å®‰å…¨&lt;/th&gt;
          &lt;th&gt;ç†ç”±&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;âœ… &lt;code&gt;os.OpenInRoot(baseDirectory, filename)&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;å®‰å…¨&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;å†…ç½®å®‰å…¨æœºåˆ¶ï¼Œè·¯å¾„æ— æ³•é€ƒé€¸&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;âŒ &lt;code&gt;os.Open(filepath.Join(baseDirectory, filename))&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;ä¸å®‰å…¨&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;å¯é€šè¿‡è·¯å¾„éå†(&lt;code&gt;../&lt;/code&gt;)æ”»å‡»é€ƒå‡º&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;âŒ æ‰‹åŠ¨æ£€æŸ¥è·¯å¾„ï¼ˆå¦‚&lt;code&gt;strings.Contains(&amp;quot;..&amp;quot;)&lt;/code&gt;ï¼‰&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;ä¸å®‰å…¨&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;æ˜“ç»•è¿‡ï¼Œä¸”æ˜“å—TOCTOUæ”»å‡»&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å› æ­¤ï¼Œ&lt;strong&gt;æ¨èå§‹ç»ˆä½¿ç”¨&lt;code&gt;os.OpenInRoot&lt;/code&gt;æˆ–&lt;code&gt;os.Root&lt;/code&gt;å¤„ç†å¤–éƒ¨æ¥æºè·¯å¾„&lt;/strong&gt;ï¼Œæœ‰æ•ˆé˜²èŒƒè·¯å¾„éå†æ”»å‡»ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;ä»¥ä¸Šå³ä¸ºè·¯å¾„éå†æ”»å‡»åŠ Go 1.24 ä¸­æ–°å®‰å…¨ API å®Œæ•´è¯¦ç»†çš„æ€»ç»“å’Œè§£é‡Šã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>fuck the life!</title>
      <link>http://localhost:1313/post/20241228/</link>
      <pubDate>Sat, 28 Dec 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/20241228/</guid>
      <description>&lt;h2 id=&#34;éšç¬”&#34;&gt;éšç¬”&lt;/h2&gt;
&lt;p&gt;æœ€è¿‘æœ‰ç‚¹è¿·èŒ«ï¼Œè¦å­¦çš„ä¸œè¥¿å¾ˆå¤šï¼Œä½†æ˜¯æ²¡æœ‰åŠ¨åŠ›å­¦ä¹ &lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>fuck the life!</title>
      <link>http://localhost:1313/post/20241216/</link>
      <pubDate>Mon, 16 Dec 2024 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/post/20241216/</guid>
      <description>&lt;h2 id=&#34;éšç¬”&#34;&gt;éšç¬”&lt;/h2&gt;
&lt;p&gt;ä¸çŸ¥é“å†™ç‚¹ä»€ä¹ˆï¼Œå°±éšä¾¿å†™å†™&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
